---
import { getCollection } from "astro:content";
import type { AstroSeoProps } from "@astrolib/seo";
import MarkdownPostLayout from "@layouts/MarkdownPostLayout.astro";

export async function getStaticPaths() {
    const projectsEntries = await getCollection("projects");

    return projectsEntries
        .map((entry) => {
            const [lang, ...slugParts] = entry.slug.split("/");
            const slug = slugParts.join("/");
            return { 
                params: { lang, slug: slug || undefined }, 
                props: { entry } 
            };
        })
        .filter((entry) => entry.params.lang === "en");
}

const { entry } = Astro.props;
const { Content } = await entry.render();

const seo: AstroSeoProps = {
    title: `${entry.data.title} — Case Study | Vantta Studio`,
    description: entry.data.description,
    canonical: `https://vantta.studio/en/work/${entry.slug.split('/').slice(1).join('/')}/`,
    openGraph: {
        url: `https://vantta.studio/en/work/${entry.slug.split('/').slice(1).join('/')}/`,
        title: `${entry.data.title} — Vantta Studio Case Study`,
        description: entry.data.description,
        type: "article",
        images: [
            {
                url: entry.data.image?.url || "https://vantta.studio/opengraph/social-og.jpg",
                width: 1200,
                height: 630,
                alt: `${entry.data.title} project preview`,
                type: "image/jpeg",
            },
        ],
        site_name: "Vantta Studio",
    },
    twitter: {
        handle: "@vanttastudio",
        site: "@vanttastudio",
        cardType: "summary_large_image",
    },
};
---

<MarkdownPostLayout frontmatter={entry.data} body={entry.body} seo={seo}>
    <div class="project-content-wrapper">
        <Content />
    </div>
</MarkdownPostLayout>

<style is:global>
    /* Optimizaciones visuales para los Case Studies de Vantta */
    .project-content-wrapper {
        animation: fadeInUp 0.8s cubic-bezier(0.16, 1, 0.3, 1) forwards;
    }

    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(30px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    /* Estilos específicos para la presentación de proyectos */
    article.prose {
        @apply max-w-none;
    }

    article.prose h1, 
    article.prose h2 {
        @apply font-display font-black uppercase tracking-tighter text-white italic;
    }

    article.prose p {
        @apply text-zinc-400 text-lg md:text-xl leading-relaxed;
    }

    /* Estilo para las imágenes de los proyectos */
    article.prose img {
        @apply rounded-3xl border border-zinc-800 shadow-2xl my-16 w-full;
        @apply transition-transform duration-700 hover:scale-[1.01];
    }

    /* Etiquetas de tecnología dentro del contenido */
    article.prose code:not(pre code) {
        @apply bg-zinc-900 text-lime-400 px-2 py-1 rounded font-mono text-sm border border-zinc-800;
    }
</style>