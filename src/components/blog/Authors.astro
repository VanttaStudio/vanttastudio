---
import { getCollection } from "astro:content";
import { Icon } from "astro-icon/components";
import { Image } from "astro:assets";
import Title from "@components/global/Title.astro";
import { getLangFromUrl, useTranslations, useTranslatedPath } from "@i18n/utils";

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
const translatePath = useTranslatedPath(lang);

const allAuthors = (await getCollection("authors"))
    .filter((author) => {
        const [authorLang, ...slug] = author.slug.split("/");
        return authorLang === lang;
    })
    .map((author) => {
        const [authorLang, slug] = author.slug.split("/");

        return {
            ...author,
            slug: slug,
        };
    });
---

<section class="bg-zinc-950 text-white min-h-screen">
    <div class="mx-auto px-8 py-24 md:px-12 lg:pt-32 2xl:max-w-7xl">
        <div class="reveal">
            <Title 
                class="pb-10 pt-20 uppercase font-black tracking-tighter text-5xl md:text-7xl lg:text-8xl" 
                title="Mentes" 
                subtitle="El equipo creativo" 
            />
        </div>

        <div class="mt-12">
            <ol class="flex flex-col border-t border-zinc-800">
                {
                    allAuthors.map((author) => (
                        <li class="group relative border-b border-zinc-800 transition-colors duration-500 hover:bg-zinc-900/30">
                            <a 
                                href={translatePath(`/authors/${author.slug}`)} 
                                class="flex w-full items-center justify-between py-12 md:py-16 px-4"
                                data-cursor-hover
                            >
                                <div class="flex items-center gap-8 md:gap-12">
                                    <div class="relative h-20 w-20 overflow-hidden rounded-full border border-zinc-700 md:h-28 md:w-28">
                                        {author.data.avatar ? (
                                            <Image 
                                                src={author.data.avatar} 
                                                alt={author.data.name}
                                                width={200}
                                                height={200}
                                                class="h-full w-full object-cover grayscale transition-all duration-500 group-hover:grayscale-0 group-hover:scale-110"
                                            />
                                        ) : (
                                            <div class="flex h-full w-full items-center justify-center bg-zinc-800 text-zinc-500 italic">
                                                {author.data.name.charAt(0)}
                                            </div>
                                        )}
                                    </div>

                                    <div class="flex flex-col gap-2">
                                        <h3 class="font-display text-3xl font-black uppercase tracking-tighter md:text-5xl lg:text-6xl text-zinc-300 group-hover:text-white transition-colors duration-300">
                                            {author.data.name}
                                        </h3>
                                        <span class="font-mono text-xs uppercase tracking-[0.3em] text-zinc-600 group-hover:text-lime-400 transition-colors">
                                            {author.data.role || "Contributor"}
                                        </span>
                                    </div>
                                </div>
                                
                                <div class="hidden md:block">
                                    <div class="flex h-16 w-16 items-center justify-center rounded-full border border-zinc-800 text-white transition-all duration-500 group-hover:border-lime-400 group-hover:bg-lime-400 group-hover:text-black">
                                        <Icon name="ic:baseline-arrow-right-alt" width="32" height="32" />
                                    </div>
                                </div>
                            </a>
                            
                            <div class="absolute bottom-0 left-0 h-px w-0 bg-lime-400 transition-all duration-700 group-hover:w-full"></div>
                        </li>
                    ))
                }
            </ol>
        </div>
    </div>
</section>

<style>
    /* Estilo de revelado sutil al cargar */
    .reveal {
        opacity: 0;
        animation: revealUp 1.2s cubic-bezier(0.16, 1, 0.3, 1) forwards;
    }

    @keyframes revealUp {
        from {
            opacity: 0;
            transform: translateY(40px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    /* Soporte para tipograf√≠a personalizada */
    .font-display {
        font-family: var(--font-display, 'Inter', sans-serif);
    }
</style>